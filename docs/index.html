
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>treesap package &#8212; TreeSAP  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">TreeSAP  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="treesap-package">
<h1>treesap package<a class="headerlink" href="#treesap-package" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/niemasd/TreeSAP">TreeSAP</a> Tree SAmpling under Phylogenetic models</p>
<div class="section" id="module-treesap">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-treesap" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="treesap.birthdeath_tree">
<code class="descclassname">treesap.</code><code class="descname">birthdeath_tree</code><span class="sig-paren">(</span><em>L</em>, <em>M</em>, <em>end_num_extant=inf</em>, <em>end_time=inf</em>, <em>max_attempts=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/birthdeath.html#birthdeath_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.birthdeath_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a birth-death tree with speciation rate L and death rate M. If both an end number of leaves and an end time are specified, the tree sampling will terminate when the first of the two is reached.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">L</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The speciation rate L</p>
<p><code class="docutils literal notranslate"><span class="pre">M</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The death rate M</p>
<p><code class="docutils literal notranslate"><span class="pre">end_num_extant</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The final number of extant leaves</p>
<p><code class="docutils literal notranslate"><span class="pre">end_time</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The final height of the tree</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">max_attempts</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The maximum number of attempts</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled birth-death tree. Leaves with label A* (for Alive) are extant, and leaves with label D* (for Dead) are extinct</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="treesap.coalescent_const_pop_tree">
<code class="descclassname">treesap.</code><code class="descname">coalescent_const_pop_tree</code><span class="sig-paren">(</span><em>pop_size</em>, <em>num_leaves</em>, <em>continuous=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/coalescent.html#coalescent_const_pop_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.coalescent_const_pop_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a coalescent tree with a constant population size`. If both an end number of leaves and an end time are specified, the tree sampling will terminate when the first of the two is reached.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">pop_size</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The population size</p>
<p><code class="docutils literal notranslate"><span class="pre">num_leaves</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The final number of leaves</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">continuous</span></code> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): <code class="docutils literal notranslate"><span class="pre">True</span></code> to simulate a continuous-time coalescent tree, or <code class="docutils literal notranslate"><span class="pre">False</span></code> to simulate a discrete-time coalescent tree</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled coalescent tree</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="treesap.dualbirth_tree">
<code class="descclassname">treesap.</code><code class="descname">dualbirth_tree</code><span class="sig-paren">(</span><em>La</em>, <em>Lb</em>, <em>end_num_leaves=inf</em>, <em>end_time=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/dualbirth.html#dualbirth_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.dualbirth_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a Dual-Birth tree with activation rate La and birth rate Lb. If both an end number of leaves and an end time are specified, the tree sampling will terminate when the first of the two is reached.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">La</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The activation rate La</p>
<p><code class="docutils literal notranslate"><span class="pre">Lb</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The birth rate Lb</p>
<p><code class="docutils literal notranslate"><span class="pre">end_num_leaves</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The final number of leaves</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">end_time</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The final height of the tree</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled Dual-Birth tree</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="treesap.nonhomogeneous_yule_tree">
<code class="descclassname">treesap.</code><code class="descname">nonhomogeneous_yule_tree</code><span class="sig-paren">(</span><em>L</em>, <em>end_num_leaves=inf</em>, <em>end_time=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/NHPP.html#nonhomogeneous_yule_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.nonhomogeneous_yule_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a non-homogeneous Yule tree with speciation rate function L(t). If both an end number of leaves and an end time are specified, the tree sampling will terminate when the first of the two is reached.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">L</span></code> (<code class="docutils literal notranslate"><span class="pre">func</span></code>): The speciation rate function L(t)</p>
<p><code class="docutils literal notranslate"><span class="pre">end_num_leaves</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The final number of leaves</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">end_time</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The final height of the tree</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled non-homogeneous Yule tree</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="treesap.transmission_neutral_coalescent_tree">
<code class="descclassname">treesap.</code><code class="descname">transmission_neutral_coalescent_tree</code><span class="sig-paren">(</span><em>transmission_network</em>, <em>sample_times</em>, <em>rate=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/transmission_neutral_coalescent.html#transmission_neutral_coalescent_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.transmission_neutral_coalescent_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a tree under the pure-neutral coalescent model constrained to a given transmission network with given patient sampling times.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">transmission_network</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): The transmission network as a <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">(u,v,t)</span></code> tuples denoting the transmission from <code class="docutils literal notranslate"><span class="pre">u</span></code> to <code class="docutils literal notranslate"><span class="pre">v</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>. The transmission network must be sorted in ascending order of time</p>
<p><code class="docutils literal notranslate"><span class="pre">sample_times</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): The times at which each individual was sampled (i.e., the times of the leaves) as a <code class="docutils literal notranslate"><span class="pre">dict</span></code> in which keys are individuals from <code class="docutils literal notranslate"><span class="pre">transmission_network</span></code> and the value associated with an individual <code class="docutils literal notranslate"><span class="pre">u</span></code> is a <code class="docutils literal notranslate"><span class="pre">list</span></code> of times at which <code class="docutils literal notranslate"><span class="pre">u</span></code> was sampled (i.e., the times of the leaves from individual <code class="docutils literal notranslate"><span class="pre">u</span></code>)</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">rate</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The rate of the Poisson process of coalescing two lineages</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled pure-neutral tree, where leaves are labeled <code class="docutils literal notranslate"><span class="pre">ID|u|t</span></code>, where <code class="docutils literal notranslate"><span class="pre">ID</span></code> is a unique identifier for the leaf, <code class="docutils literal notranslate"><span class="pre">u</span></code> is the corresponding individual from <code class="docutils literal notranslate"><span class="pre">transmission_network</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> is the sample time (which equals the leaf’s distance from the root). If there are multiple seed individuals (infected beforehand), a tree will be output for each.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="treesap.yule_tree">
<code class="descclassname">treesap.</code><code class="descname">yule_tree</code><span class="sig-paren">(</span><em>L</em>, <em>end_num_leaves=inf</em>, <em>end_time=inf</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treesap/yule.html#yule_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treesap.yule_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a Yule tree with speciation rate L. If both an end number of leaves and an end time are specified, the tree sampling will terminate when the first of the two is reached.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">L</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The speciation rate L</p>
<p><code class="docutils literal notranslate"><span class="pre">end_num_leaves</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The final number of leaves</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">end_time</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): The final height of the tree</p>
</dd>
<dt>Returns:</dt>
<dd>A <code class="docutils literal notranslate"><span class="pre">Tree</span></code> object storing the sampled Yule tree</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">treesap package</a><ul>
<li><a class="reference internal" href="#module-treesap">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">TreeSAP  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Niema Moshiri.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>